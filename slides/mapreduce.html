<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>
        
        MapReduce | CS 341: System Programming
        
    </title>

    <meta name="author" content="" />

    <!-- Description -->
    
    <meta name="description" content=""Webpage for CS 341: System Programming at the University of Illinois at Urbana-Champaign. All documentation and information about the course can be found here."
">
    

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/reveal.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/theme/black.css" id="theme"/>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="/css/code-style.css"/>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? '/reveal.js/css/print/pdf.css' : '/reveal.js/css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!-- <link rel="apple-touch-icon" href="/apple-touch-icon.png" /> -->

    <link rel="canonical" href="http://cs341.cs.illinois.edu/slides/mapreduce">

    <style>
     .reveal pre {
         box-shadow: none;
     }
     .reveal pre.highlight {
         margin: 0px 0px 0px 0px;
         width: 100%;
         height: 100%;
         font-size: 20px;
     }
     #toggle-chalkboard {
	       left: 60px !important;
	       bottom: 32px !important;
     }
     #toggle-notes {
	       left: 93px !important;
	       bottom: 32px !important;
     }
    </style>
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="reveal">
        <div class="slides">
<section>
      <h1 class="title">MapReduce</h1>
      <h2 class="author"></h2>
</section><section><h1></h1>
<section><h2 id="inter-process-communication">Inter Process Communication</h2>

</section><section><h2></h2>

<p>The goal of Inter Process Communication (IPC) is to communicate between different <em>processes</em>.</p>
<ul>
  <li>Pipes</li>
  <li>Sockets</li>
  <li>Shared Memory</li>
</ul>

</section></section><section><h1></h1>

<section><h2 id="pipes">Pipes</h2>

<p>A pipe takes in a stream of bytes from an input file descriptor, and spits out the data through an output file descriptor.</p>

</section><section><h2 id="how-are-pipes-used">How are pipes used?</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; ls -1 | cut -d'.' -f1 | sort | uniq | tee dirents
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/illinois-cs241/coursebook/master/ipc/drawings/pipe_process.png" alt="Pipes"></p>

<p>What is going on with this command? How many processes are spawned here?</p>

</section><section><h2></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; ls -1 | cut -d'.' -f1 | sort | uniq | tee dirents
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/illinois-cs241/coursebook/master/ipc/drawings/pipe_process.png" alt="Pipes"></p>

<p>There are 5 processes spawned. The stdout (fd 1) of one process is connected to the stdin (fd 0) of the next process through a pipe.</p>

</section></section><section><h1></h1>

<section><h2 id="pipes-in-code">Pipes in code</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int pipe(int pipefd[2]);
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">pipe()</code> takes in a single argument - an array of size 2.</p>

<p><code class="language-plaintext highlighter-rouge">pipefd[0]</code> will be set to the file descriptor to read from.</p>

<p><code class="language-plaintext highlighter-rouge">pipefd[1]</code> will be set to the file descriptor to write to.</p>

</section><section><h2></h2>

<p>How does the reading end of the pipe know when it’s done reading?</p>

<p><code class="language-plaintext highlighter-rouge">read()</code> will return 0 when all writers close their ends.</p>

<p>If a writer has not closed their end of the pipe yet, <code class="language-plaintext highlighter-rouge">read()</code> will just block.</p>

</section><section><h2></h2>

<p>How does the writing end of the pipe know when there’s no more readers?</p>

<p>If all file descriptors referring to the read end of a pipe have been closed,
then a <code class="language-plaintext highlighter-rouge">write()</code> will cause a <code class="language-plaintext highlighter-rouge">SIGPIPE</code> signal to be generated for the writing process.</p>

</section></section><section><h1></h1>

<section><h2 id="other-facts-about-pipes">Other facts about pipes</h2>

</section><section><h2></h2>

<p>How much data can a pipe hold?</p>

<p>The maximum size is dependent on the system, but usually it ranges from 4 KiB to 128 KiB.</p>

</section><section><h2></h2>

<p>What happens if the pipe is full?</p>

<p>Writing to the pipe will block if a pipe is full. It will unblock once data is read from the pipe.</p>

</section><section><h2></h2>

<p><code class="language-plaintext highlighter-rouge">pipe()</code> vs <code class="language-plaintext highlighter-rouge">pipe2()</code></p>

<p><code class="language-plaintext highlighter-rouge">pipe2()</code> has an additional argument (<code class="language-plaintext highlighter-rouge">flags</code>).</p>

<p>One flag that might be useful is <code class="language-plaintext highlighter-rouge">O_CLOEXEC</code>. It closes both pipe file descriptors if a successful <code class="language-plaintext highlighter-rouge">exec</code> occurs.</p>

</section></section><section><h1></h1>

<section><h2 id="mapreduce">Mapreduce</h2>

</section><section><h2 id="what-is-mapreduce">What is MapReduce?</h2>

<p>MapReduce is a programming model developed at Google for efficiently exploiting parallel and distributed computing systems for processing large datasets.
Programs that use the MapReduce module consist of a “mapper” function, which consumes some type of input and produces zero, one, or more <code class="language-plaintext highlighter-rouge">(key, value)</code> pairs from that input.
Then, a “reducer” method performs a summary operation across all of the <code class="language-plaintext highlighter-rouge">(key, value)</code> pairs to produce a (set) of results.</p>

</section></section><section><h1></h1>

<section><h2 id="example">Example</h2>

<p>Suppose we wanted to find the count of each word (word frequency) in a large document in a parallel manner. We would split up the document into smaller chunks, and distribute them across a number of processes or machines. Each machine could then map each word <code class="language-plaintext highlighter-rouge">w</code> to the key-value pair <code class="language-plaintext highlighter-rouge">(w, 1)</code>. A reducer would then iterate through the key value pairs and combine duplicates by adding them. The final result will then be a set of pairs <code class="language-plaintext highlighter-rouge">(word, count)</code> where <code class="language-plaintext highlighter-rouge">count</code> is the number of times <code class="language-plaintext highlighter-rouge">word</code> appears in the document.</p>

</section></section><section><h1></h1>

<section><h2 id="visualization">Visualization</h2>

<p><img src="https://user-images.githubusercontent.com/3259988/137649801-e741375d-2904-4ab8-81b1-558d05b78302.png" alt="MapReduce"></p>

</section></section><section><h1></h1>

<section><h2 id="parallel-mapping">Parallel Mapping</h2>

<p>MapReduce is parallelizable because we can run the mappers and reducers across multiple threads/processes/machines. The mapping operation is independent per input element, so we can easily divide up the work of mapping. We simply take the input, split it up into a predefined number of chunks, and distribut each chunk to a mapper process.</p>

</section><section><h2></h2>

</section><section><h2 id="parallel-reducing">Parallel Reducing</h2>

<p>The reducing should also be parallelizable. We can run a single reducer for <em>all</em> of the mapped outputs, or we can also multiple reducers for each chunk and then reduce <em>those</em> results to produce the final answer. We can even layer this operation to use multiple stacked layers of reducers. This is only possible because the reduce operation needs to be associative, so <code class="language-plaintext highlighter-rouge">reduce(A[1...n]) = reduce(reduce(A[1...n/2]) + reduce(A[n/2...n]))</code>.</p>

</section></section><section><h1></h1>

<section><h2 id="your-assignment">Your Assignment</h2>

<p>In this lab, you will be implementing the MapReduce infrastructure, i.e. the “orchestrator” for MapReduce that splits up the inputs, sends them off to the mappers, and then agglomerates the mapped outputs into a final result via a reducer. You will not need to implement any mappers or reducers yourself, and a tool is provided for splitting up the input.</p>

</section><section><h2></h2>

</section><section><h2 id="implementation">Implementation</h2>

<p>Your program will be called as <code class="language-plaintext highlighter-rouge">./mapreduce &lt;input_file&gt; &lt;output_file&gt; &lt;mapper_executable&gt; &lt;reducer_executable&gt; &lt;mapper_count&gt;</code>.</p>

</section><section><h2></h2>

<p>Your program will do the following:</p>

<ol>
  <li>Split the input file into <code class="language-plaintext highlighter-rouge">&lt;mapper_count&gt;</code> chunks using the given <code class="language-plaintext highlighter-rouge">splitter</code> tool.</li>
  <li>Start a mapper executable for each input chunk, and pipe the output of each mapper process into the input of the singular reducer process.</li>
  <li>Pipe the output of the reducer process to the output file.</li>
</ol>
</section></section>
</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/lib/js/head.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/js/reveal.js"></script>
    <script>
     // Full list of configuration options available at:
     // https://github.com/hakimel/reveal.js#configuration
     Reveal.initialize({
         controls: true,
         progress: true,
         history: true,
         center: true,
         // Optional reveal.js plugins
         dependencies: [
             { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
             { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/zoom-js/zoom.js', async: true },
             { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/notes/notes.js', async: true },
             { src: '/js/reveal.js/menu/menu.js', async: true},
             { src: '/js/reveal.js/chalkboard/chalkboard.js', async: true},
         ]
     });

    </script>
  </body>
</html>
